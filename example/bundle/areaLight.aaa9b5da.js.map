{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,8HAWA,IAAIC,EAAUC,EAAUC,EAAmBC,EAAwBC,EAAYC,EAAWC,EAAYC,EAAQC,EAC1GC,EAAWC,EACf,MAAMC,EAAS,CAEdC,UAAU,EAEVC,mBAAmB,EACnBC,sBAAsB,EACtBC,oBAAqB,EACrBC,gBAAiB,UACjBC,gBAAiB,EACjBC,iBAAkB,EAElBC,mBAAmB,EACnBC,sBAAsB,EACtBC,oBAAqB,GACrBC,gBAAiB,UACjBC,gBAAiB,KACjBC,iBAAkB,KAElBC,qBAAsB,IACtBC,oBAAqB,EAErBC,QAAS,EACTC,gBAAiB,EACjBC,gBAAiB,EAAIC,OAAOC,iBAC5BC,mBAAoB,GACpBC,MAAO,EACPC,4BAA4B,GAqQ7B,SAASC,IAER/B,EAAY,GAAIgC,WAAazB,EAAOG,qBACpCV,EAAY,GAAIiC,UAAY1B,EAAOI,oBACnCX,EAAY,GAAIkC,MAAQ3B,EAAOM,gBAC/Bb,EAAY,GAAImC,OAAS5B,EAAOO,iBAChCd,EAAY,GAAIoC,MAAMC,IAAK9B,EAAOK,iBAAkB0B,sBAEpDtC,EAAY,GAAIgC,WAAazB,EAAOS,qBACpChB,EAAY,GAAIiC,UAAY1B,EAAOU,oBACnCjB,EAAY,GAAIkC,MAAQ3B,EAAOY,gBAC/BnB,EAAY,GAAImC,OAAS5B,EAAOa,iBAChCpB,EAAY,GAAIoC,MAAMC,IAAK9B,EAAOW,iBAAkBoB,sBAEpD,MAAMC,EAAgB,GACjBhC,EAAOE,mBAAoB8B,EAAcC,KAAMxC,EAAY,IAC3DO,EAAOQ,mBAAoBwB,EAAcC,KAAMxC,EAAY,IAEhEE,EAAWuC,SAASC,OAAOC,WAAYJ,GACvCrC,EAAW0C,QAIZ,SAASC,IAER,MAAMC,EAAIpB,OAAOqB,WACXC,EAAItB,OAAOuB,YACXC,EAAQ3C,EAAOkB,gBACf0B,EAAMzB,OAAOC,iBAEnBzB,EAAWkD,QAASN,EAAII,EAAQC,EAAKH,EAAIE,EAAQC,GACjDjD,EAAW0C,QAEXhD,EAASwD,QAASN,EAAGE,GACrBpD,EAASyD,cAAe3B,OAAOC,iBAAmBuB,GAClD/C,EAAOmD,OAASR,EAAIE,EACpB7C,EAAOoD,yBAIR,SAASC,IAERC,sBAAuBD,GAEvBtD,EAAWuC,SAASiB,UAAUf,WAAY1C,EAAUyD,UAAWzD,EAAU0D,UACzEzD,EAAWuC,SAASC,OAAOC,WAAY3C,GAEvCE,EAAWuC,SAASb,mBAAqBrB,EAAOqB,mBAChD1B,EAAWuC,SAASpB,qBAAuBd,EAAOc,qBAClDnB,EAAWuC,SAASmB,gBAAkB,IACtC1D,EAAWuC,SAASlB,QAAUhB,EAAOgB,QAErCpB,EAAO0D,oBAEP,IAAM,IAAIC,EAAI,EAAGC,EAAIxD,EAAOiB,gBAAiBsC,EAAIC,EAAGD,IAEnD5D,EAAW8D,SAIZpE,EAASqE,WAAY,EACrB7D,EAAO8D,OAAQtE,GACfA,EAASsE,OAAQnE,EAAwBI,GACzCP,EAASqE,WAAY,EAErB5D,EAAU8D,UAAY,YAAaC,KAAKC,MAAOnE,EAAWoE,WAjUvC5C,OAAOqB,WAAarB,OAAOuB,YAC5B,MAElB1C,EAAOgB,QAAU6C,KAAKG,IAAKhE,EAAOgB,QAAS,IAC3ChB,EAAOkB,iBAAmB,GAC1BlB,EAAOsB,MAAQ,GAchB2C,iBAEC5E,EAAW,IAAIF,EAAA+E,cAAqB,CAAEC,WAAW,IACjD9E,EAAS+E,eAAiBjF,EAAAkF,aAC1BhF,EAASiF,YAAcnF,EAAAoF,sBACvBC,SAASC,KAAKC,YAAarF,EAASsF,YAEpC/E,EAAS,IAAIT,EAAAyF,kBAAyB,GAAIzD,OAAOqB,WAAarB,OAAOuB,YAAa,KAAO,KACzF9C,EAAOiF,SAAS/C,IAAK,EAAK,GAAK,MAE/BnC,EAAa,IAAImF,EAAAC,oBAAqB1F,GACtCM,EAAWqF,OAASpF,EACpBD,EAAWuC,SAAW,IAAI4C,EAAAG,4BAC1BtF,EAAW2B,MAAMQ,IAAK9B,EAAOsB,MAAOtB,EAAOsB,OAE3CzB,EAAS,IAAIqF,EAAAC,eAAgB,IAAIhG,EAAAiG,kBAAyB,CACzDC,IAAK1F,EAAW2F,OAAOC,WAGxBjG,EAAW,IAAIkG,EAAAC,cAAe7F,EAAQP,EAASsF,YAC/CrF,EAASgG,OAAOxD,IAAK,EAAG,KAAM,KAC9BlC,EAAO8F,OAAQpG,EAASgG,QACxBhG,EAASqG,iBAAkB,UAAU,KAEpChG,EAAW0C,WAGZ/C,EAASmE,SAET7D,EAAO8F,QAAQ,IAAQ,KAAM,KAE7B5F,EAAY0E,SAASoB,eAAgB,WACrC7F,EAAYyE,SAASoB,eAAgB,WAErC,MAAMC,GAAgB,IAAIC,EAAAC,YACxBC,UAAW,iGACXC,MAAMV,IAEN5F,EAAWuC,SAASgE,WAAW9D,WAAYmD,MAIvCY,EAAQ,IAAIhH,EAAAiH,MAEZC,EAAM,IAAIlH,EAAAmH,MA3GjBC,MA4GSA,SAAgB,IAAIC,EAAAC,YAC1BC,kBAAmBC,EAAAC,gBACnBZ,UAAW,8GAEbO,EAAMM,UAAUC,IAEVA,EAAE5E,WAAW4E,EAAE5E,SAASmD,IAAM,SAIpCkB,EAAM5D,MAAMoE,UAAW,KAEvBR,EAAM1B,SAASmC,EAAI,IACnBT,EAAMjD,mBAAmB,GAEzB+C,EAAIY,cAAeV,GACnBA,EAAM1B,SAASqC,GAAKb,EAAIrC,IAAIkD,EAE5Bf,EAAMgB,IAAKZ,GAEX,MAAMa,EAAY,IAAIjI,EAAAkI,uBAA8B,IAAK,IAAK,IAAM,IAC9DC,EAAW,IAAInI,EAAAoI,qBAA4B,CAAE1F,MAAO,IAAI1C,EAAAqI,MAAa,UAAYC,UAAW,GAAKC,UAAW,MAC5G5D,EAAQ,IAAI3E,EAAAwI,KAAYP,EAAWE,GACzCxD,EAAMe,SAASqC,GAAI,KACnBf,EAAMgB,IAAKrD,GAQXqC,EAAM7C,oBAEN,MAAMsE,EAAa,IAAI9C,EAAA+C,gBAAiB,IAAI1I,EAAAqI,MAAa,UAAY,EAAK,EAAK,GAC/EI,EAAW/C,SAASmC,EAAI,IACxBY,EAAW/C,SAASqC,EAAI,EACxBU,EAAW/C,SAASiD,GAAI,GACxBF,EAAWG,SAAWlE,KAAKmE,GAAK,GAChCJ,EAAWK,SAAWpE,KAAKmE,GAAK,GAChCJ,EAAWnG,YAAa,EACxB0E,EAAMgB,IAAKS,GAEX,MAAMM,EAAa,IAAIpD,EAAA+C,gBAAiB,IAAI1I,EAAAqI,MAAa,UAAY,GAAM,KAAM,MACjFU,EAAWrD,SAASqC,EAAI,KACxBgB,EAAWrD,SAASiD,GAAI,IACxBI,EAAWD,QAASpE,KAAKmE,IACzBE,EAAWzG,YAAa,EACxB0E,EAAMgB,IAAKe,GAEXzI,EAAa,CAAEmI,EAAYM,GAE3B3I,EAAoB,IAAI4I,EAAAC,kBAAmBxI,EAAQP,EAASsF,YAC5DpF,EAAkBoG,iBAAkB,gBAAgB,KAEnDhG,EAAWuC,SAASC,OAAOC,WAAY3C,GACvCE,EAAW0C,WAGZ9C,EAAkBoG,iBAAkB,oBAAsB0C,GAAO/I,EAASgJ,SAAYD,EAAEE,QACxFhJ,EAAkBiJ,OAAQZ,GAC1BrI,EAAkBsD,QAAS,IAE3B1B,OAAOwE,iBAAkB,WAAW,SAAW8C,GAE9C,OAASA,EAAMC,KAEf,IAAK,IACJnJ,EAAkBoJ,QAAS,aAC3B,MAED,IAAK,IACJpJ,EAAkBoJ,QAAS,cAO7BnJ,EAAyB,IAAIL,EAAAyJ,MAC7BpJ,EAAuB2H,IAAK5H,GAE5B,MAAMsJ,EAAY,IAAIC,EAAAC,uBAChBC,EAAmBH,EAAUI,SAAU9C,EAAO,CACnD+C,WAAYC,GAEXpJ,EAAU6D,UAAY,kBAAmBC,KAAKuF,MAAO,IAAMD,SAGzDlD,MAAMoD,IAET3J,EAAY2J,EAEZ,MAzMFC,IAyMUA,EAzMVlG,SAyMeA,EAzMfD,UAyMyBA,EAzMzBhB,OAyMoCA,GAAWkH,EACvCE,EAAWD,EAAIC,SACfrH,EAAWvC,EAAWuC,SAE5BA,EAASoH,IAAIlH,WAAYkH,GACzBpH,EAASsH,gBAAgBpH,WAAYmH,EAASE,WAAWC,QACzDxH,EAASyH,iBAAiBvH,WAAYmH,EAASE,WAAWG,SAC1D1H,EAAS2H,YAAYzH,WAAYmH,EAASE,WAAWK,IACrD5H,EAAS6H,uBAAuB3H,WAAYmH,EAASE,WAAWO,eAChE9H,EAASkB,SAAS6G,YAAa5K,EAAU,KAAM,KAAM+D,GACrDlB,EAASiB,UAAUf,WAAYe,EAAWC,GAC1ClB,EAASC,OAAOC,WAAYD,GAC5BD,EAASgI,WAAa/H,EAAOgI,OAE7BtB,EAAUuB,mBAILC,QAAQC,IAAK,CAAEtB,EAAkBnD,IAEvCrB,SAASoB,eAAgB,WAAY2E,SAErCjI,IACAnB,OAAOwE,iBAAkB,SAAUrD,GAEnC,MAAMkI,EAAM,IAAIC,EAAAC,IAChBF,EAAIrD,IAAKnH,EAAQ,YAAa2K,UAAUxB,IAEvC5J,EAAkB+I,QAAUa,EAC5B5J,EAAkBqL,QAAUzB,KAG7B,MAAM0B,EAAWL,EAAIM,UAAW,gBAChCD,EAAS1D,IAAKnH,EAAQ,QAAS,EAAG,EAAG,GAAI2K,UAAUpC,IAElD5I,EAAW2B,MAAMQ,IAAKyG,EAAOA,MAG9BsC,EAAS1D,IAAKnH,EAAQ,kBAAmB,EAAG,GAAI,GAChD6K,EAAS1D,IAAKnH,EAAQ,qBAAsB,EAAG,GAAI2K,UAAU,KAE5DhL,EAAW0C,WAGZwI,EAAS1D,IAAKnH,EAAQ,UAAW,EAAG,GAAI,GAAI2K,UAAU,KAErDhL,EAAW0C,WAGZwI,EAAS1D,IAAKnH,EAAQ,kBAAmB,GAAK,GAAI2K,UAAU,KAE3DrI,OAGDuI,EAAS1D,IAAKnH,EAAQ,8BAA+B2K,UAAU,KAE9DhL,EAAWuC,SAAS6I,QAAQC,YAAchL,EAAOuB,2BAA6B,EAAI,EAClF5B,EAAWuC,SAAS+I,aAAc,EAClCtL,EAAW0C,WAGZwI,EAASK,QAET,MAAMC,EAAYX,EAAIM,UAAW,eACjCK,EAAUhE,IAAKnH,EAAQ,uBAAwB,EAAG,GAAI2K,UAAU,KAE/DhL,EAAW0C,WAGZ8I,EAAUhE,IAAKnH,EAAQ,sBAAuB,EAAG,EAAI6D,KAAKmE,IAAK2C,UAAUxB,IAExExJ,EAAWuC,SAASnB,oBAAoBqK,gBAAgB,IAAIjM,EAAAkM,SAAgBC,cAAenC,IAC3FxJ,EAAW0C,WAGZ8I,EAAUD,QAEV,MAAMK,EAAmBf,EAAIM,UAAW,gBACxCS,EAAiBpE,IAAKnH,EAAQ,qBAAsBwL,KAAM,UAAWb,SAAUnJ,GAC/E+J,EAAiBpE,IAAKnH,EAAQ,wBAAyBwL,KAAM,cAAeb,SAAUnJ,GACtF+J,EAAiBpE,IAAKnH,EAAQ,sBAAuB,EAAG,KAAMwL,KAAM,aAAcb,SAAUnJ,GAC5F+J,EAAiBE,SAAUzL,EAAQ,mBAAoBwL,KAAM,SAAUb,SAAUnJ,GACjF+J,EAAiBpE,IAAKnH,EAAQ,kBAAmB,EAAG,GAAIwL,KAAM,SAAUb,SAAUnJ,GAClF+J,EAAiBpE,IAAKnH,EAAQ,mBAAoB,EAAG,GAAIwL,KAAM,UAAWb,SAAUnJ,GAEpF,MAAMkK,EAAmBlB,EAAIM,UAAW,gBACxCY,EAAiBvE,IAAKnH,EAAQ,qBAAsBwL,KAAM,UAAWb,SAAUnJ,GAC/EkK,EAAiBvE,IAAKnH,EAAQ,wBAAyBwL,KAAM,cAAeb,SAAUnJ,GACtFkK,EAAiBvE,IAAKnH,EAAQ,sBAAuB,EAAG,KAAMwL,KAAM,aAAcb,SAAUnJ,GAC5FkK,EAAiBD,SAAUzL,EAAQ,mBAAoBwL,KAAM,SAAUb,SAAUnJ,GACjFkK,EAAiBvE,IAAKnH,EAAQ,kBAAmB,EAAG,GAAIwL,KAAM,SAAUb,SAAUnJ,GAClFkK,EAAiBvE,IAAKnH,EAAQ,mBAAoB,EAAG,GAAIwL,KAAM,UAAWb,SAAUnJ,GAEpFA,IAEAyB,IAnPD0I","sources":["example/areaLight.js"],"sourcesContent":["import * as THREE from 'three';\nimport { FullScreenQuad } from 'three/examples/jsm/postprocessing/Pass.js';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { PathTracingRenderer, PhysicalPathTracingMaterial, ShapedAreaLight } from '../src/index.js';\nimport { PathTracingSceneWorker } from '../src/workers/PathTracingSceneWorker.js';\nimport { RGBELoader } from 'three/examples/jsm/loaders/RGBELoader.js';\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min.js';\nimport { TransformControls } from 'three/examples/jsm/controls/TransformControls.js';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { MeshoptDecoder } from 'three/examples/jsm/libs/meshopt_decoder.module.js';\n\nlet renderer, controls, transformControls, transformControlsScene, areaLights, sceneInfo, ptRenderer, camera, fsQuad;\nlet samplesEl, loadingEl;\nconst params = {\n\n\tcontrols: true,\n\n\tareaLight1Enabled: true,\n\tareaLight1IsCircular: false,\n\tareaLight1Intensity: 2,\n\tareaLight1Color: '#ffffff',\n\tareaLight1Width: 1,\n\tareaLight1Height: 1,\n\n\tareaLight2Enabled: true,\n\tareaLight2IsCircular: false,\n\tareaLight2Intensity: 10,\n\tareaLight2Color: '#ff0000',\n\tareaLight2Width: 1.25,\n\tareaLight2Height: 2.75,\n\n\tenvironmentIntensity: 0.03,\n\tenvironmentRotation: 0,\n\n\tbounces: 3,\n\tsamplesPerFrame: 1,\n\tresolutionScale: 1 / window.devicePixelRatio,\n\tfilterGlossyFactor: 0.5,\n\ttiles: 1,\n\tmultipleImportanceSampling: true\n\n};\n\n// clamp value for mobile\nconst aspectRatio = window.innerWidth / window.innerHeight;\nif ( aspectRatio < 0.65 ) {\n\n\tparams.bounces = Math.min( params.bounces, 10 );\n\tparams.resolutionScale *= 0.5;\n\tparams.tiles = 3;\n\n}\n\ninit();\n\n// other sculptures\n// * https://sketchfab.com/3d-models/nile-42e02439c61049d681c897441d40aaa1\n// * https://sketchfab.com/3d-models/statue-of-bacchus-09f1c94f43e0400c8916149bab297918\n// https://sketchfab.com/3d-models/2-aliens-figure-a58af7bd939d46fca4eb46e43588944f\n// * https://sketchfab.com/3d-models/lowe-4afeca000f444619ad581a30aa4fd17e\n// * https://sketchfab.com/3d-models/laocoon-and-his-sons-649111a9a7b74ddab3937292be5545fc\n// * https://sketchfab.com/3d-models/mercury-about-to-kill-argos-by-b-thorvaldsen-bdcd0813bf54467fb879ee1681a3a6d3\n\nasync function init() {\n\n\trenderer = new THREE.WebGLRenderer( { antialias: true } );\n\trenderer.outputEncoding = THREE.sRGBEncoding;\n\trenderer.toneMapping = THREE.ACESFilmicToneMapping;\n\tdocument.body.appendChild( renderer.domElement );\n\n\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.025, 500 );\n\tcamera.position.set( 0.0, 0.6, 2.65 );\n\n\tptRenderer = new PathTracingRenderer( renderer );\n\tptRenderer.camera = camera;\n\tptRenderer.material = new PhysicalPathTracingMaterial();\n\tptRenderer.tiles.set( params.tiles, params.tiles );\n\n\tfsQuad = new FullScreenQuad( new THREE.MeshBasicMaterial( {\n\t\tmap: ptRenderer.target.texture,\n\t} ) );\n\n\tcontrols = new OrbitControls( camera, renderer.domElement );\n\tcontrols.target.set( 0, 0.33, - 0.08 );\n\tcamera.lookAt( controls.target );\n\tcontrols.addEventListener( 'change', () => {\n\n\t\tptRenderer.reset();\n\n\t} );\n\tcontrols.update();\n\n\tcamera.lookAt( - 0.15, 0.33, - 0.08 );\n\n\tsamplesEl = document.getElementById( 'samples' );\n\tloadingEl = document.getElementById( 'loading' );\n\n\tconst envMapPromise = new RGBELoader()\n\t\t.loadAsync( 'https://raw.githubusercontent.com/gkjohnson/3d-demo-data/master/hdri/leadenhall_market_1k.hdr' )\n\t\t.then( texture => {\n\n\t\t\tptRenderer.material.envMapInfo.updateFrom( texture );\n\n\t\t} );\n\n\tconst group = new THREE.Group();\n\n\tconst box = new THREE.Box3();\n\tconst { scene } = await new GLTFLoader()\n\t\t.setMeshoptDecoder( MeshoptDecoder )\n\t\t.loadAsync( 'https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/mercury-about-to-kill-argos/scene.glb' );\n\n\tscene.traverse( c => {\n\n\t\tif ( c.material ) c.material.map = null;\n\n\t} );\n\n\tscene.scale.setScalar( 0.01 );\n\t// scene.rotation.x = - Math.PI / 2;\n\tscene.position.x = 0.05;\n\tscene.updateMatrixWorld( true );\n\n\tbox.setFromObject( scene );\n\tscene.position.y -= box.min.y;\n\n\tgroup.add( scene );\n\n\tconst floorGeom = new THREE.CylinderBufferGeometry( 3.5, 3.5, 0.05, 60 );\n\tconst floorMat = new THREE.MeshPhysicalMaterial( { color: new THREE.Color( 0x999999 ), metalness: 0.2, roughness: 0.02 } );\n\tconst floor = new THREE.Mesh( floorGeom, floorMat );\n\tfloor.position.y = - 0.025;\n\tgroup.add( floor );\n\n\t// const redBoxGeom = new THREE.BoxBufferGeometry( 0.1, 2, 2 );\n\t// const redBoxMat = new THREE.MeshPhysicalMaterial( { color: new THREE.Color( 0xFF0000 ) } );\n\t// const redBox = new THREE.Mesh( redBoxGeom, redBoxMat );\n\t// redBox.position.set( - 1.5, 1.0, 0.0 );\n\t// // group.add( redBox );\n\n\tgroup.updateMatrixWorld();\n\n\tconst areaLight1 = new ShapedAreaLight( new THREE.Color( 0xFFFFFF ), 5.0, 1.0, 1.0 );\n\tareaLight1.position.x = 1.5;\n\tareaLight1.position.y = 1.0;\n\tareaLight1.position.z = - 0.5;\n\tareaLight1.rotateZ( - Math.PI / 4 );\n\tareaLight1.rotateX( - Math.PI / 2 );\n\tareaLight1.isCircular = false;\n\tgroup.add( areaLight1 );\n\n\tconst areaLight2 = new ShapedAreaLight( new THREE.Color( 0xFF0000 ), 15.0, 1.25, 2.75 );\n\tareaLight2.position.y = 1.25;\n\tareaLight2.position.z = - 1.5;\n\tareaLight2.rotateX( Math.PI );\n\tareaLight2.isCircular = false;\n\tgroup.add( areaLight2 );\n\n\tareaLights = [ areaLight1, areaLight2 ];\n\n\ttransformControls = new TransformControls( camera, renderer.domElement );\n\ttransformControls.addEventListener( 'objectChange', () => {\n\n\t\tptRenderer.material.lights.updateFrom( areaLights );\n\t\tptRenderer.reset();\n\n\t} );\n\ttransformControls.addEventListener( 'dragging-changed', ( e ) => controls.enabled = ! e.value );\n\ttransformControls.attach( areaLight1 );\n\ttransformControls.setSize( 0.5 );\n\n\twindow.addEventListener( 'keydown', function ( event ) {\n\n\t\tswitch ( event.key ) {\n\n\t\tcase 'w':\n\t\t\ttransformControls.setMode( 'translate' );\n\t\t\tbreak;\n\n\t\tcase 'e':\n\t\t\ttransformControls.setMode( 'rotate' );\n\t\t\tbreak;\n\n\t\t}\n\n\t} );\n\n\ttransformControlsScene = new THREE.Scene();\n\ttransformControlsScene.add( transformControls );\n\n\tconst generator = new PathTracingSceneWorker();\n\tconst generatorPromise = generator.generate( group, {\n\t\tonProgress( v ) {\n\n\t\t\tloadingEl.innerText = `Generating BVH ${ Math.round( 100 * v ) }%`;\n\n\t\t}\n\t} ).then( result => {\n\n\t\tsceneInfo = result;\n\n\t\tconst { bvh, textures, materials, lights } = result;\n\t\tconst geometry = bvh.geometry;\n\t\tconst material = ptRenderer.material;\n\n\t\tmaterial.bvh.updateFrom( bvh );\n\t\tmaterial.normalAttribute.updateFrom( geometry.attributes.normal );\n\t\tmaterial.tangentAttribute.updateFrom( geometry.attributes.tangent );\n\t\tmaterial.uvAttribute.updateFrom( geometry.attributes.uv );\n\t\tmaterial.materialIndexAttribute.updateFrom( geometry.attributes.materialIndex );\n\t\tmaterial.textures.setTextures( renderer, 2048, 2048, textures );\n\t\tmaterial.materials.updateFrom( materials, textures );\n\t\tmaterial.lights.updateFrom( lights );\n\t\tmaterial.lightCount = lights.length;\n\n\t\tgenerator.dispose();\n\n\t} );\n\n\tawait Promise.all( [ generatorPromise, envMapPromise ] );\n\n\tdocument.getElementById( 'loading' ).remove();\n\n\tonResize();\n\twindow.addEventListener( 'resize', onResize );\n\n\tconst gui = new GUI();\n\tgui.add( params, 'controls' ).onChange( v => {\n\n\t\ttransformControls.enabled = v;\n\t\ttransformControls.visible = v;\n\n\t} );\n\tconst ptFolder = gui.addFolder( 'Path Tracing' );\n\tptFolder.add( params, 'tiles', 1, 4, 1 ).onChange( value => {\n\n\t\tptRenderer.tiles.set( value, value );\n\n\t} );\n\tptFolder.add( params, 'samplesPerFrame', 1, 10, 1 );\n\tptFolder.add( params, 'filterGlossyFactor', 0, 1 ).onChange( () => {\n\n\t\tptRenderer.reset();\n\n\t} );\n\tptFolder.add( params, 'bounces', 1, 15, 1 ).onChange( () => {\n\n\t\tptRenderer.reset();\n\n\t} );\n\tptFolder.add( params, 'resolutionScale', 0.1, 1 ).onChange( () => {\n\n\t\tonResize();\n\n\t} );\n\tptFolder.add( params, 'multipleImportanceSampling' ).onChange( () => {\n\n\t\tptRenderer.material.defines.FEATURE_MIS = params.multipleImportanceSampling ? 1 : 0;\n\t\tptRenderer.material.needsUpdate = true;\n\t\tptRenderer.reset();\n\n\t} );\n\tptFolder.close();\n\n\tconst envFolder = gui.addFolder( 'Environment' );\n\tenvFolder.add( params, 'environmentIntensity', 0, 3 ).onChange( () => {\n\n\t\tptRenderer.reset();\n\n\t} );\n\tenvFolder.add( params, 'environmentRotation', 0, 2 * Math.PI ).onChange( v => {\n\n\t\tptRenderer.material.environmentRotation.setFromMatrix4( new THREE.Matrix4().makeRotationY( v ) );\n\t\tptRenderer.reset();\n\n\t} );\n\tenvFolder.close();\n\n\tconst areaLight1Folder = gui.addFolder( 'Area Light 1' );\n\tareaLight1Folder.add( params, 'areaLight1Enabled' ).name( 'enable' ).onChange( updateLights );\n\tareaLight1Folder.add( params, 'areaLight1IsCircular' ).name( 'isCircular' ).onChange( updateLights );\n\tareaLight1Folder.add( params, 'areaLight1Intensity', 0, 200 ).name( 'intensity' ).onChange( updateLights );\n\tareaLight1Folder.addColor( params, 'areaLight1Color' ).name( 'color' ).onChange( updateLights );\n\tareaLight1Folder.add( params, 'areaLight1Width', 0, 5 ).name( 'width' ).onChange( updateLights );\n\tareaLight1Folder.add( params, 'areaLight1Height', 0, 5 ).name( 'height' ).onChange( updateLights );\n\n\tconst areaLight2Folder = gui.addFolder( 'Area Light 2' );\n\tareaLight2Folder.add( params, 'areaLight2Enabled' ).name( 'enable' ).onChange( updateLights );\n\tareaLight2Folder.add( params, 'areaLight2IsCircular' ).name( 'isCircular' ).onChange( updateLights );\n\tareaLight2Folder.add( params, 'areaLight2Intensity', 0, 200 ).name( 'intensity' ).onChange( updateLights );\n\tareaLight2Folder.addColor( params, 'areaLight2Color' ).name( 'color' ).onChange( updateLights );\n\tareaLight2Folder.add( params, 'areaLight2Width', 0, 5 ).name( 'width' ).onChange( updateLights );\n\tareaLight2Folder.add( params, 'areaLight2Height', 0, 5 ).name( 'height' ).onChange( updateLights );\n\n\tupdateLights();\n\n\tanimate();\n\n}\n\nfunction updateLights() {\n\n\tareaLights[ 0 ].isCircular = params.areaLight1IsCircular;\n\tareaLights[ 0 ].intensity = params.areaLight1Intensity;\n\tareaLights[ 0 ].width = params.areaLight1Width;\n\tareaLights[ 0 ].height = params.areaLight1Height;\n\tareaLights[ 0 ].color.set( params.areaLight1Color ).convertSRGBToLinear();\n\n\tareaLights[ 1 ].isCircular = params.areaLight2IsCircular;\n\tareaLights[ 1 ].intensity = params.areaLight2Intensity;\n\tareaLights[ 1 ].width = params.areaLight2Width;\n\tareaLights[ 1 ].height = params.areaLight2Height;\n\tareaLights[ 1 ].color.set( params.areaLight2Color ).convertSRGBToLinear();\n\n\tconst enabledLights = [];\n\tif ( params.areaLight1Enabled ) enabledLights.push( areaLights[ 0 ] );\n\tif ( params.areaLight2Enabled ) enabledLights.push( areaLights[ 1 ] );\n\n\tptRenderer.material.lights.updateFrom( enabledLights );\n\tptRenderer.reset();\n\n}\n\nfunction onResize() {\n\n\tconst w = window.innerWidth;\n\tconst h = window.innerHeight;\n\tconst scale = params.resolutionScale;\n\tconst dpr = window.devicePixelRatio;\n\n\tptRenderer.setSize( w * scale * dpr, h * scale * dpr );\n\tptRenderer.reset();\n\n\trenderer.setSize( w, h );\n\trenderer.setPixelRatio( window.devicePixelRatio * scale );\n\tcamera.aspect = w / h;\n\tcamera.updateProjectionMatrix();\n\n}\n\nfunction animate() {\n\n\trequestAnimationFrame( animate );\n\n\tptRenderer.material.materials.updateFrom( sceneInfo.materials, sceneInfo.textures );\n\tptRenderer.material.lights.updateFrom( areaLights );\n\n\tptRenderer.material.filterGlossyFactor = params.filterGlossyFactor;\n\tptRenderer.material.environmentIntensity = params.environmentIntensity;\n\tptRenderer.material.environmentBlur = 0.35;\n\tptRenderer.material.bounces = params.bounces;\n\n\tcamera.updateMatrixWorld();\n\n\tfor ( let i = 0, l = params.samplesPerFrame; i < l; i ++ ) {\n\n\t\tptRenderer.update();\n\n\t}\n\n\trenderer.autoClear = false;\n\tfsQuad.render( renderer );\n\trenderer.render( transformControlsScene, camera );\n\trenderer.autoClear = true;\n\n\tsamplesEl.innerText = `Samples: ${ Math.floor( ptRenderer.samples ) }`;\n\n}\n"],"names":["$ilwiq","parcelRequire","$840382748b150f6e$var$renderer","$840382748b150f6e$var$controls","$840382748b150f6e$var$transformControls","$840382748b150f6e$var$transformControlsScene","$840382748b150f6e$var$areaLights","$840382748b150f6e$var$sceneInfo","$840382748b150f6e$var$ptRenderer","$840382748b150f6e$var$camera","$840382748b150f6e$var$fsQuad","$840382748b150f6e$var$samplesEl","$840382748b150f6e$var$loadingEl","$840382748b150f6e$var$params","controls","areaLight1Enabled","areaLight1IsCircular","areaLight1Intensity","areaLight1Color","areaLight1Width","areaLight1Height","areaLight2Enabled","areaLight2IsCircular","areaLight2Intensity","areaLight2Color","areaLight2Width","areaLight2Height","environmentIntensity","environmentRotation","bounces","samplesPerFrame","resolutionScale","window","devicePixelRatio","filterGlossyFactor","tiles","multipleImportanceSampling","$840382748b150f6e$var$updateLights","isCircular","intensity","width","height","color","set","convertSRGBToLinear","enabledLights","push","material","lights","updateFrom","reset","$840382748b150f6e$var$onResize","w","innerWidth","h","innerHeight","scale","dpr","setSize","setPixelRatio","aspect","updateProjectionMatrix","$840382748b150f6e$var$animate","requestAnimationFrame","materials","textures","environmentBlur","updateMatrixWorld","i","l","update","autoClear","render","innerText","Math","floor","samples","min","async","WebGLRenderer","antialias","outputEncoding","sRGBEncoding","toneMapping","ACESFilmicToneMapping","document","body","appendChild","domElement","PerspectiveCamera","position","$4CEV9","PathTracingRenderer","camera","PhysicalPathTracingMaterial","$RPVlj","FullScreenQuad","MeshBasicMaterial","map","target","texture","$5Rd1x","OrbitControls","lookAt","addEventListener","getElementById","envMapPromise","$891vQ","RGBELoader","loadAsync","then","envMapInfo","group","Group","box","Box3","scene","$7lx9d","GLTFLoader","setMeshoptDecoder","$kp7Te","MeshoptDecoder","traverse","c","setScalar","x","setFromObject","y","add","floorGeom","CylinderBufferGeometry","floorMat","MeshPhysicalMaterial","Color","metalness","roughness","Mesh","areaLight1","ShapedAreaLight","z","rotateZ","PI","rotateX","areaLight2","$fUhpq","TransformControls","e","enabled","value","attach","event","key","setMode","Scene","generator","$cVdfP","PathTracingSceneWorker","generatorPromise","generate","onProgress","v","round","result","bvh","geometry","normalAttribute","attributes","normal","tangentAttribute","tangent","uvAttribute","uv","materialIndexAttribute","materialIndex","setTextures","lightCount","length","dispose","Promise","all","remove","gui","$jiuw3","GUI","onChange","visible","ptFolder","addFolder","defines","FEATURE_MIS","needsUpdate","close","envFolder","setFromMatrix4","Matrix4","makeRotationY","areaLight1Folder","name","addColor","areaLight2Folder","$840382748b150f6e$var$init"],"version":3,"file":"areaLight.aaa9b5da.js.map"}