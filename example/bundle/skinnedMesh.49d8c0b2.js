var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},a=e.parcelRequire5b70;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in n){var a=n[e];delete n[e];var r={id:e,exports:{}};return t[e]=r,a.call(r.exports,r,r.exports),r.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},e.parcelRequire5b70=a);var r=a("ilwiq"),o=a("RPVlj"),i=a("7lx9d"),s=a("5Rd1x"),l=a("4CEV9"),d=a("891vQ"),u=a("kp7Te"),c=a("jiuw3"),m=a("1EdOY");let p,w,h,g,x,b,v,f,y,M,P=0;const E={environmentIntensity:1,bounces:3,samplesPerFrame:1,resolutionScale:1/window.devicePixelRatio,tiles:1,autoPause:!0,pause:!1,continuous:!1};function F(e){y.action.paused=e,E.pause=e,e&&S()}function R(e){return(new i.GLTFLoader).setMeshoptDecoder(u.MeshoptDecoder).loadAsync(e).then((e=>{e.scene.traverse((e=>{e.material&&(e.material.metalness=0,e.material.map=null)}));const t=e.animations,n=new r.AnimationMixer(e.scene),a=n.clipAction(t[0]);a.play(),a.paused=E.pause;const o=new r.Group;o.add(e.scene);const i=m.generateRadialFloorTexture(2048),s=new r.Mesh(new r.PlaneGeometry,new r.MeshStandardMaterial({map:i,transparent:!0,color:14540253,roughness:.15,metalness:1}));s.scale.setScalar(50),s.rotation.x=-Math.PI/2,s.position.y=.075,o.add(s);return{scene:o,sceneGenerator:new l.DynamicPathTracingSceneGenerator(o),mixer:n,action:a}}))}function C(){const e=window.innerWidth,t=window.innerHeight,n=E.resolutionScale,a=window.devicePixelRatio;g.setSize(e*n*a,t*n*a),g.reset(),p.setSize(e,t),p.setPixelRatio(window.devicePixelRatio*n),x.aspect=e/t,x.updateProjectionMatrix()}function S(){const{scene:e,sceneGenerator:t}=y,n=t.generate(e);h=n;const{bvh:a,textures:r,materials:o}=n,i=a.geometry,s=g.material;s.bvh.updateFrom(a),s.normalAttribute.updateFrom(i.attributes.normal),s.tangentAttribute.updateFrom(i.attributes.tangent),s.uvAttribute.updateFrom(i.attributes.uv),s.materialIndexAttribute.updateFrom(i.attributes.materialIndex),s.textures.setTextures(p,2048,2048,r),s.materials.updateFrom(o,r),g.reset()}function T(){requestAnimationFrame(T);const e=Math.min(f.getDelta(),.03);if(y.mixer.update(e),y.scene.updateMatrixWorld(),E.autoPause?(P+=e,(!E.pause&&P>=2.5||E.pause&&P>=5)&&(F(!E.pause),P=0)):P=0,E.pause||E.continuous){!E.pause&&E.continuous&&S(),g.material.materials.updateFrom(h.materials,h.textures),g.material.environmentIntensity=E.environmentIntensity,g.material.environmentBlur=.35,g.material.bounces=E.bounces,x.updateMatrixWorld();for(let e=0,t=E.samplesPerFrame;e<t;e++)g.update();g.samples<1&&p.render(v,x),p.autoClear=!1,b.render(p),p.autoClear=!0,M.innerText=`Samples: ${Math.floor(g.samples)}`}else p.render(v,x)}window.innerWidth/window.innerHeight<.65&&(E.resolutionScale*=.5,E.tiles=2),async function(){p=new r.WebGLRenderer({antialias:!0}),p.toneMapping=r.ACESFilmicToneMapping,p.outputEncoding=r.sRGBEncoding,document.body.appendChild(p.domElement),v=new r.Scene,x=new r.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.025,500),x.position.set(5.5,3.5,7.5),g=new l.PathTracingRenderer(p),g.camera=x,g.material=new l.PhysicalPathTracingMaterial,g.material.filterGlossyFactor=.25,g.material.setDefine("FEATURE_MIS",0),g.tiles.set(E.tiles,E.tiles),b=new o.FullScreenQuad(new r.MeshBasicMaterial({map:g.target.texture,transparent:!0})),w=new s.OrbitControls(x,p.domElement),w.target.set(-.15,2,-.08),x.lookAt(w.target),w.addEventListener("change",(()=>{g.reset()})),w.update(),M=document.getElementById("samples"),f=new r.Clock;const e=(new d.RGBELoader).loadAsync("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/equirectangular/royal_esplanade_1k.hdr").then((e=>{const t=new l.BlurredEnvMapGenerator(p),n=t.generate(e,.35);g.material.envMapInfo.updateFrom(n),t.dispose(),v.background=n,v.environment=n}));y="#morphtarget"===window.location.hash?await R("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/models/gltf/RobotExpressive/RobotExpressive.glb"):await R("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/trex/scene.gltf");v.add(y.scene),await e,document.getElementById("loading").remove(),C(),window.addEventListener("resize",C);const t=new c.GUI;t.add(E,"tiles",1,4,1).onChange((e=>{g.tiles.set(e,e)})),t.add(E,"samplesPerFrame",1,10,1),t.add(E,"environmentIntensity",0,10).onChange((()=>{g.reset()})),t.add(E,"bounces",1,5,1).onChange((()=>{g.reset()})),t.add(E,"resolutionScale",.1,1).onChange((()=>{C()})),t.add(E,"autoPause").listen(),t.add(E,"pause").onChange((e=>{E.autoPause=!1,F(e)})).listen(),t.add(E,"continuous").onChange((()=>{E.autoPause=!1})),T()}();
//# sourceMappingURL=skinnedMesh.49d8c0b2.js.map
